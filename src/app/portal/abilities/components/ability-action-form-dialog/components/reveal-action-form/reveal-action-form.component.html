<form [formGroup]="actionForm" class="flex flex-col gap-2">
  <div class="flex flex-col gap-1">
    <gow-select-field
      label="Objetivo"
      placeholder="Selecciona el objetivo a revelar"
      [options]="abilityRevealTargetOptions"
      [enableClear]="false"
      [focusColor]="colorScheme()"
      formControlName="target"
    />

    @if (targetControl?.invalid && (targetControl?.touched || targetControl?.dirty)) {
      @if (hasErrorValidation(targetControl, "required")) {
        <p class="text-sm text-red-500">Es requerido</p>
      }
    }
  </div>

  @if (targetControl?.value !== abilityRevealTarget.YOURSELF) {
    <div class="flex flex-col gap-1 mb-2">
      <gow-number-field
        label="Cantidad de objetivos"
        placeholder="Ingrese la cantidad máxima de objetivos"
        formControlName="maxTargets"
        [focusColor]="colorScheme()"
      />

      @if (maxTargetsControl?.invalid && maxTargetsControl?.touched) {
        @if (hasErrorValidation(maxTargetsControl, "required")) {
          <p class="text-sm text-red-500">Es requerido</p>
        } @else if (hasErrorValidation(maxTargetsControl, "min")) {
          <p class="text-sm text-red-500">
            Mínimo debe ser {{ maxTargetsControl?.errors?.["min"].min }} objetivo
          </p>
        } @else if (hasErrorValidation(maxTargetsControl, "max")) {
          <p class="text-sm text-red-500">
            Máximo debe ser {{ maxTargetsControl?.errors?.["max"].max }} objetivo
          </p>
        }
      }
    </div>
  }

  <div class="flex flex-col gap-1">
    <div class="flex items-center gap-1.5">
      <p>Información a revelar</p>

      @if (informationControl?.invalid && (informationControl?.touched || informationControl?.dirty)) {
        @if (hasErrorValidation(informationControl, "required")) {
          <p class="text-sm text-red-500">Es requerido</p>
        } @else if (hasErrorValidation(informationControl, "minimumOneDiscoveryInformationActive")) {
          <p class="text-sm text-red-500">
            Mínimo uno de estos datos debe estar activo
          </p>
        } @else if (hasErrorValidation(maxTargetsControl, "max")) {
          <p class="text-sm text-red-500">
            Máximo debe ser {{ maxTargetsControl?.errors?.["max"].max }} objetivo
          </p>
        }
      }
    </div>

    <div class="flex flex-wrap gap-4">
      @for (information of discoveryInformationOptions; track position; let position = $index) {
        @if (getDiscoveryInformationControl(information.value); as discoveryInformationControl) {
          <label class="flex items-center flex-col gap-2 px-1">
            <div class="p-6 rounded-xl flex items-center justify-center cursor-pointer {{ discoveryInformationControl.value && 'shadow-lg outline outline-gray-100' }}">
              <i-lucide [img]="information.icon" class="size-[25px] {{ information.filled && 'fill-gray-800' }}" />
            </div>
            <span class="text-base {{ discoveryInformationControl.value && 'font-bold' }}">
              {{ information.name }}
            </span>
            <input
              type="checkbox"
              class="hidden"
              [formControl]="discoveryInformationControl"
            />
          </label>
        }
      }
    </div>
  </div>
</form>
